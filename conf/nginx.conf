daemon off;
worker_processes auto;
error_log log/error.log info;
pid run/nginx.pid;

events {
	worker_connections 1024;
}

http {
	log_format  main    '$remote_addr - $remote_user [$time_local] "$request" '
	                    '$status $body_bytes_sent "$http_referer" '
	                    '"$http_user_agent" "$http_x_forwarded_for"';

	sendfile            on;
	tcp_nopush          on;
	tcp_nodelay         on;
	keepalive_timeout   65;
	types_hash_max_size 2048;

	include             /etc/nginx/mime.types;
	default_type        application/octet-stream;

	access_log          log/access.log main;

	client_body_temp_path     tmp/client_body;
	proxy_temp_path           tmp/proxy;
	fastcgi_temp_path         tmp/fastcgi;
	uwsgi_temp_path           tmp/uwsgi;
	scgi_temp_path            tmp/scgi;

	server {
		listen 8080;

		root www;

		location /stream.mp3 {
			proxy_buffering off;
			proxy_pass http://localhost:8090;
		}
	}

	server {
		listen 8081;

		root www;

		location / {
			proxy_pass http://localhost:8070;
		}
	}
}
